"""
流浪纪元模块
技术窃取成功后的星际逃亡
"""

def wanderer_era_1(game):
    """流浪纪元：秘密建造"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    流浪纪元：秘密建造
═══════════════════════════════════════

【流浪纪元开始】

在澳洲内陆的秘密基地，
人类工程师夜以继日地工作。

维德站在建造中的飞船前：
"这是人类文明的最后希望。"

窃取的三体技术被破解、改进、应用：

**技术突破：**
✓ 曲率驱动引擎（光速飞行）
✓ 反物质能源（无限续航）
✓ 生命维持系统（世代飞船）
✓ 智子屏蔽（摆脱监控）

五年后：

**舰队规模：**
- 建成战舰：50艘
- 单舰载人：2万人
- 总载人量：100万人
- 航程：可达半人马座α星以外

罗辑看着数据，叹息：
"100万人...只是全人类的0.03%。
剩下的29.9亿人怎么办？"

程心哭泣："我们不能抛弃他们..."

维德冷酷地说："我们没有选择。
资源只够建造50艘飞船。
如果等待更多飞船，三体人会发现我们。"

AA提出建议："我们可以抽签，
让命运决定谁能登船。"

维德摇头："抽签？太天真了。
我们应该带走最有价值的人：
科学家、工程师、军人...
只有精英才能重建文明。"

罗辑沉思："两种方案各有道理。
但无论哪种，我们都在抛弃大部分人类..."

程心绝望："这不公平..."

维德冷笑："公平？在生存面前，
公平毫无意义。"

舰队指挥官（你）必须做出最艰难的决定：

1. 【抽签登船】公平抽签，100万幸运儿
2. 【精英优先】带走科学家、工程师、军人等精英
3. 【继续建造】再建造更多飞船，拖延时间（可能被发现）""")
    
    game.add_button("选择1", lambda: game.choice(1, 0, 3, 0, 2, wanderer_era_2_lottery))
    game.add_button("选择2", lambda: game.choice(2, 3, -2, 1, 0, wanderer_era_2_elite))
    game.add_button("选择3", lambda: game.choice(0, 2, 2, 0, 3, wanderer_era_2_delay))

def wanderer_era_2_lottery(game):
    """流浪纪元：大逃亡"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    流浪纪元：大逃亡
═══════════════════════════════════════

你选择了抽签。

全球30亿人，100万个名额。
中签率：0.033%。

抽签结果公布的那一天，
澳洲保留区陷入了疯狂。

**中签者：**
- 欣喜若狂，感谢命运
- 匆忙收拾行李
- 与家人告别

**未中签者：**
- 绝望哭泣
- 暴动抗议
- 试图贿赂、偷渡

发射场外，人山人海。

一个母亲抱着中签的孩子哭喊：
"带我走！求你们！我的孩子只有5岁！
他一个人怎么活？"

一个老人跪在地上：
"我儿子中签了，但我没有...
让我替他去吧，他还年轻..."

一个科学家愤怒地质问维德：
"为什么我没中签？
我是物理学家！我对人类更有价值！"

维德冷冷地回答：
"抽签就是抽签。
命运面前，人人平等。"

程心看着这一切，泪流满面。

AA拉着她的手："我们必须走了。
三体人发现了舰队！
水滴正在赶来！"

罗辑在指挥中心下令：
"所有飞船，立即起飞！
不能再等了！"

引擎点火。

50艘战舰缓缓升空。

地面上，29.9亿人仰望天空。

有人哭泣，有人诅咒，有人祈祷...

程心透过舷窗看着地球：
"对不起...对不起..."

维德站在她身边：
"不要回头。
我们是人类文明的最后火种。
我们必须活下去。"

飞船加速，突破大气层。

身后，水滴摧毁了发射场。
那些留下的人，在爆炸中化为灰烬...

地球越来越小，最终消失在黑暗中。

前方，是无尽的星空和未知的命运。

你必须决定舰队的航向：

1. 【寻找新家园】前往最近的适居星球
2. 【游击战】在星际间打游击，骚扰三体
3. 【回归复仇】积蓄力量，百年后反攻地球""")
    
    from .endings import ending
    game.add_button("选择1", lambda: game.choice(2, 2, 2, 0, 2, lambda g: ending(g, "wanderer_new_home")))
    game.add_button("选择2", lambda: game.choice(3, 1, 0, 3, 1, lambda g: ending(g, "wanderer_guerrilla")))
    game.add_button("选择3", lambda: game.choice(2, 2, 1, 3, 2, lambda g: ending(g, "wanderer_revenge")))

def wanderer_era_2_elite(game):
    """流浪纪元：精英主义"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    流浪纪元：精英主义
═══════════════════════════════════════

你选择了精英优先。

维德亲自制定登船名单：

**名单构成：**
- 科学家：30万（物理、化学、生物、工程）
- 工程师：20万（飞船维护、建筑、制造）
- 军人：20万（保卫舰队安全）
- 政府官员：10万（管理和决策）
- 医生、教师、艺术家：20万（文明传承）

普通人被排除在外。

当名单泄露，澳洲保留区爆发了史无前例的暴动。

"凭什么只有精英能走？"
"我们也是人类！"
"这不公平！"

30亿人冲向发射场。

维德下令："开火。"

机枪扫射，血流成河。

罗辑闭上眼睛："这是必要的牺牲..."

程心崩溃了："不！停下！
我们不能杀自己的同胞！"

AA拉住她："程心，我们没有选择。
如果不阻止他们，飞船会被摧毁，
那样所有人都会死！"

暴动被镇压。

发射场外，尸横遍野。

舰队在血泊中起飞。

船上的人透过舷窗看着地面的尸体，
许多人呕吐，许多人哭泣。

维德在广播中说：
"我知道你们心中的愧疚。
但记住，我们是人类文明的最后希望。
我们必须活下去，
才能让那些牺牲有意义。"

罗辑补充：
"我们欠他们的。
在新世界，我们必须建立更好的文明，
一个不会抛弃任何人的文明。"

程心哭着说：
"我发誓...
如果人类文明能延续，
我们永远不会忘记今天的罪孽..."

飞船驶向星空。

船上的人永远无法忘记：
他们是踩着同胞的尸体逃走的。

这份原罪，将伴随他们一生。

你必须决定如何面对这份罪孽：

1. 【负罪前行】带着愧疚建立新文明，但永远无法原谅自己
2. 【自我救赎】发誓要让新文明更公平，以此赎罪""")
    
    from .endings import ending
    game.add_button("选择1", lambda: game.choice(1, 2, -2, 1, 0, lambda g: ending(g, "wanderer_guilt")))
    game.add_button("选择2", lambda: game.choice(2, 2, 3, 0, 3, lambda g: ending(g, "wanderer_redemption")))

def wanderer_era_2_delay(game):
    """流浪纪元：被发现"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    流浪纪元：被发现
═══════════════════════════════════════

你选择继续建造飞船。

"再等一年，"你对维德说，
"我们能多建造30艘飞船，
多救60万人！"

维德犹豫："风险太大..."

程心支持你："我们不能放弃他们！
每一个生命都很重要！"

罗辑警告："智子无处不在。
我们拖延的越久，被发现的概率越高。"

AA负责情报："我会加强反侦察措施。"

一年后，舰队规模扩大到80艘。

但就在最后一艘飞船即将完工时...

警报响起！

智子出现在基地上空：
"人类，你们以为能瞒过我吗？
我一直在观察你们。
只是想看看，你们能做到什么程度。"

"现在，游戏结束了。"

水滴从天而降。

基地被摧毁。
80艘飞船被击毁。
160万人的希望化为灰烬。

维德在爆炸中死去，临终前说：
"我早就说过...不该等..."

程心跪在废墟中：
"都是我的错...又是我的错..."

罗辑叹息："善良，有时候是最大的罪恶。"

抵抗组织全军覆没。

三体人加强了对澳洲的控制。

人类失去了最后的希望。

═══════════════════════════════════════
结局：流浪计划失败
生存: {survival} | 科技: {technology} | 道德: {morality}
═══════════════════════════════════════

人类永远失去了逃离的机会。

在澳洲保留区，30亿人绝望地等待死亡。

三体人冷笑："这就是反抗的代价。"

一千年后，人类成为三体文明的附庸种族。

地球的历史被改写。
人类的文明被遗忘。

只有在古老的传说中，
还流传着"流浪舰队"的故事...

但那只是传说。""")
    
    game.add_button("重新开始", lambda: game.choice(0, 0, 0, 0, 0, game.start_game))
