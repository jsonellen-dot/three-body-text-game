"""
解放纪元模块
重建威慑后的地球解放
"""

def liberation_era_1(game):
    """解放纪元：威慑重建"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    解放纪元：威慑重建
═══════════════════════════════════════

【解放纪元开始】

奇迹发生了！

【武器路线】
经过三年的秘密建造，
罗辑的"宇宙广播器"终于完成。

在澳洲内陆的秘密基地，
巨大的天线指向星空。

罗辑站在控制台前：
"这是人类的最后一搏。"

他按下按钮。

电磁波以光速向宇宙传播，
携带着三体世界的精确坐标...

智子震惊地出现：
"你们疯了！你们会害死所有人！"

罗辑冷笑："现在，轮到我们威慑你们了。
立即撤离地球，否则我们继续广播！"

【外交路线】
程心与智子的秘密谈判持续了三年。

她向三体议会展示了：
- 人类的艺术和文化
- 科技创新的潜力
- 和平共处的诚意

三体和平派领袖被打动了。

在三体世界，一场政变爆发。
和平派推翻了战争派。

新政府向地球发来信息：
"我们为过去的侵略道歉。
我们将归还地球主权。"

【无论哪条路线，结果是：】

三体舰队开始撤离。

智子最后一次出现在程心面前：
"程心，你赢了。
但记住，宇宙是黑暗的。
威慑只是暂时的平衡。"

人类重获地球控制权！

**解放进程：**
- 第1个月：亚洲解放
- 第3个月：欧洲解放
- 第6个月：美洲解放
- 第9个月：非洲解放
- 第12个月：澳洲保留区解散

30亿人走出保留区，回到故乡。

在北京天安门广场，
维德宣布："黑暗纪元结束！
解放纪元开始！"

人群欢呼雀跃。

程心哭泣："我们终于做到了..."

罗辑看着天空，若有所思：
"但新的危机正在酝酿...
我们向宇宙广播了坐标，
其他文明会注意到我们..."

AA担忧："三体人会反扑吗？"

维德冷静分析：
"我们必须做好准备。
解放只是开始，
真正的挑战还在后面。"

你必须决定解放后的发展方向：

1. 【重建地球】专注于恢复地球文明，医治战争创伤
2. 【防范三体】保持警惕，建立防御系统防止三体反扑
3. 【宇宙探索】利用窃取的技术探索宇宙，寻找新家园""")
    
    game.add_button("选择1", lambda: game.choice(1, 1, 3, 0, 2, liberation_era_2_rebuild))
    game.add_button("选择2", lambda: game.choice(2, 2, 0, 2, 1, liberation_era_2_defense))
    game.add_button("选择3", lambda: game.choice(1, 3, 0, 1, 1, liberation_era_2_explore))

def liberation_era_2_rebuild(game):
    """解放纪元：重建家园"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    解放纪元：重建家园
═══════════════════════════════════════

地球满目疮痍。

三体人留下的是：
- 被开采殆尽的矿山
- 被污染的河流和海洋
- 被摧毁的城市和基础设施
- 30亿人口的心理创伤

程心负责重建计划：

**第一阶段（1-5年）：**
- 清理三体设施
- 恢复农业生产
- 重建基础设施
- 治疗心理创伤

**第二阶段（5-20年）：**
- 重建城市
- 恢复工业
- 发展科技
- 重建文化

**第三阶段（20-50年）：**
- 恢复生态
- 达到战前水平
- 超越过去

在上海，摩天大楼从废墟中重建。
在北京，故宫被修复如初。
在纽约，自由女神像重新矗立。

孩子们在废墟中玩耍，
工人们在重建城市，
农民们在恢复农田，
科学家们在研究新技术...

人类充满希望。

但罗辑一直在监测宇宙信号。

十年后的一天，他脸色苍白地找到程心：

"程心，我们有麻烦了。"

他打开星图：
"我监测到一个未知文明的舰队，
正在向太阳系接近。

他们的速度...是光速的10%。
预计50年后抵达。"

程心震惊："是谁？"

罗辑苦笑："我不知道。
但他们显然收到了我们的广播。

根据黑暗森林法则，
他们来这里只有一个目的：
清除我们。"

维德立即召开紧急会议：
"我们必须做好准备！"

AA分析："50年时间，
我们可以建立防御系统。"

程心绝望："难道和平只是幻觉吗？
我们刚刚摆脱三体，
又要面对新的敌人？"

罗辑叹息："这就是宇宙的真相。
黑暗森林法则，永远有效。"

你必须决定：

1. 【继续重建】无视威胁，专注重建，享受短暂的和平
2. 【准备迎战】立即转入战时状态，建造防御系统""")
    
    from .endings import ending
    game.add_button("选择1", lambda: game.choice(0, 0, 3, 0, 2, lambda g: ending(g, "liberation_peace")))
    game.add_button("选择2", lambda: game.choice(2, 3, 0, 3, 1, liberation_era_3_war))

def liberation_era_2_defense(game):
    """解放纪元：防御建设"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    解放纪元：防御建设
═══════════════════════════════════════

维德主导了防御计划。

"我们不能重蹈覆辙，"
他在联合国大会上说，
"三体人可能随时反扑。
我们必须建立强大的防御系统！"

**防御计划：**

**太空防御：**
- 在木星轨道建立防御舰队
- 1000艘战舰（使用窃取的三体技术）
- 配备曲率驱动和反物质武器

**地球防御：**
- 全球导弹防御网
- 激光武器系统
- 电磁脉冲防护

**火星基地：**
- 建立备用指挥中心
- 储备资源和人口
- 作为最后的避难所

**威慑系统：**
- 保持宇宙广播器运行
- 随时可以广播三体坐标
- 维持威慑平衡

罗辑负责战略规划：
"我们必须假设最坏的情况。
三体人可能会再次进攻。"

AA负责情报：
"我们在三体舰队中安插了间谍。
目前三体内部分裂严重，
和平派和战争派在内战。"

程心担忧："我们把所有资源都用于军事，
人民的生活怎么办？"

维德冷酷地说：
"活着，才有资格谈生活。"

二十年后，防御系统建成。

人类拥有了强大的太空舰队。

但就在这时，罗辑监测到异常信号：

"不是三体...是另一个文明！"

一个未知文明的舰队正在接近太阳系。

他们发来信息：
"我们收到了你们的广播。
根据黑暗森林法则，
你们必须被清除。"

维德立即下令：
"全军进入战斗状态！"

人类舰队在木星轨道集结。

这将是人类文明的最后一战...

你必须决定战术：

1. 【主动出击】在木星轨道迎战，保卫太阳系
2. 【诱敌深入】让敌人进入太阳系，利用地形优势
3. 【谈判求和】尝试与对方沟通，避免战争""")
    
    game.add_button("选择1", lambda: game.choice(2, 2, 0, 3, 1, liberation_era_3_war))
    game.add_button("选择2", lambda: game.choice(3, 2, 0, 2, 1, liberation_era_3_war))
    from .endings import ending
    game.add_button("选择3", lambda: game.choice(0, 1, 3, 0, 2, lambda g: ending(g, "liberation_diplomacy")))

def liberation_era_2_explore(game):
    """解放纪元：宇宙探索"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    解放纪元：宇宙探索
═══════════════════════════════════════

罗辑提出了大胆的计划：

"我们不能坐以待毙。
宇宙是危险的，但也充满机会。

我们应该主动探索宇宙，
寻找新的家园，
寻找盟友，
寻找更强大的技术。"

**探索计划：**

**近程探索（10光年内）：**
- 半人马座α星系
- 天狼星系
- 南门二星系
- 寻找适居行星

**远程探索（100光年内）：**
- 派遣无人探测器
- 寻找其他文明
- 收集宇宙情报

**技术研发：**
- 改进曲率驱动（达到光速）
- 研发虫洞技术
- 探索高维空间

维德支持这个计划：
"进攻是最好的防御。
我们必须主动出击。"

程心担忧："但这会暴露我们的位置..."

罗辑摇头："我们已经暴露了。
广播坐标的那一刻，
整个宇宙都知道我们在这里。

与其被动等待，
不如主动寻找出路。"

AA负责探索舰队：
"我们建造了100艘探索飞船，
每艘载有1000人。
他们将前往不同的星系。"

十年后，探索舰队出发。

**探索成果：**

**半人马座α星系：**
- 发现适居行星
- 建立殖民地
- 人口：10万

**天狼星系：**
- 发现古老文明遗迹
- 获得先进技术
- 但文明已灭绝

**南门二星系：**
- 遭遇敌对文明
- 舰队被摧毁
- 无人生还

**意外发现：**
在距离地球50光年的地方，
探索队发现了一个奇特的信号...

那是云天明发来的信息！

"程心，我还活着。
我在三体世界找到了一个秘密...
一个可以拯救人类的秘密..."

程心激动地哭泣：
"云天明！你还活着！"

但信息突然中断。

罗辑分析："这可能是陷阱。"

维德冷静："也可能是真的。
我们必须派人去确认。"

你必须决定：

1. 【前往救援】派遣舰队前往三体世界，寻找云天明
2. 【继续探索】这可能是陷阱，继续探索其他星系""")
    
    from .endings import ending
    game.add_button("选择1", lambda: game.choice(1, 2, 3, 1, 2, lambda g: ending(g, "liberation_yun")))
    game.add_button("选择2", lambda: game.choice(2, 3, 0, 1, 1, lambda g: ending(g, "liberation_explore")))

def liberation_era_3_war(game):
    """解放纪元：新的威胁"""
    game.clear_buttons()
    game.show_text("""═══════════════════════════════════════
    解放纪元：人类的最后一战
═══════════════════════════════════════

未知文明的舰队抵达了。

他们的科技远超人类和三体：
- 舰队规模：10000艘
- 武器：维度打击、黑洞炸弹
- 防御：力场护盾、时间扭曲

人类舰队在木星轨道迎战。

维德在旗舰上下令：
"全军，为了人类文明，冲锋！"

罗辑在地球指挥中心：
"启动宇宙广播器！
广播敌人的坐标！"

程心哭泣："又是战争...
难道永远不会有和平吗？"

AA握着她的手：
"至少，我们战斗过。"

战斗打响！

**第一波攻击：**
- 人类发射反物质导弹
- 敌人启动力场护盾
- 导弹被弹开

**第二波攻击：**
- 人类使用曲率驱动撞击
- 敌人使用维度打击
- 100艘人类战舰被降维

**第三波攻击：**
- 罗辑广播敌人坐标
- 敌人冷笑："我们早就暴露了。"
- 威慑失败

**最后的抵抗：**
维德下令："启动最后手段！"

人类引爆了木星。

巨大的爆炸吞噬了敌人舰队的一部分。

但代价是：
- 人类舰队全军覆没
- 木星消失
- 太阳系轨道混乱

敌人舰队受损，但仍在前进。

他们向地球发射了"二向箔"。

罗辑看着监控屏幕：
"这就是结局吗..."

程心绝望："我们失败了..."

维德最后的通讯：
"至少...我们战斗到了最后..."

二向箔抵达地球。

三维空间开始坍缩为二维。

地球、火星、太阳...
整个太阳系被降维。

人类文明，就此终结。

但在遥远的星系，
那些探索舰队还在航行...

人类的火种，还未熄灭。

═══════════════════════════════════════
结局：人类的最后一战
生存: {survival} | 科技: {technology} | 道德: {morality}
═══════════════════════════════════════

太阳系被降维为二维画卷。

在二维世界中，
地球的历史被永远定格。

但在宇宙深处，
人类的探索舰队还在前进。

他们是人类文明的最后希望。

也许有一天，
他们会在新的星球上重建文明。

也许有一天，
他们会为地球复仇。

但那是另一个故事了...""")
    
    game.add_button("重新开始", lambda: game.choice(0, 0, 0, 0, 0, game.start_game))
